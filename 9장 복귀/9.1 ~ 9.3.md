# 9장 복귀

---

# 9.1 되돌리기

<br>

## 9.1.1 다시 시작

+ 깃은 기록된 커밋을 기준으로 이전 상태로 되돌릴 수 있음

+ 코드 작업을 되돌리는 방법은 크게 **reset** 과 **revert** 두 가지가 있음

<br>
<br>

# 9.2 리셋

+ 리셋은 커밋을 기준으로 이전 코드로 되돌리는 방법으로, 기록한 커밋을 취소

<br>

## 9.2.1 복귀 시점

+ 복귀는 어떤 시점으로 돌아가는 것을 의미하고 이전 코드로 복귀하려면 복귀 시점을 알려주어야 함

+ 리셋은 이 커밋을 기준으로 정하고 커밋은 log 명령어로 조회 가능

+ ![9 2 1-1](https://user-images.githubusercontent.com/107418955/202680913-e49893d7-8d6f-4cbd-9f19-73ad421fc5c8.png)

+ ![9 2 1](https://user-images.githubusercontent.com/107418955/202680926-f77b868b-c2f2-4047-a113-cf0d4ebe78e0.png)

+ 마지막 커밋 ID에 HEAD포인터가 존재

+ 커밋 메시지는 여러 줄로 작성할 수 있지만 로그 기록은 그 중 첫 번째 메시지만 출력

+ `$ git reset --hard HEAD^^^` : 이처럼 캐럿(^) 혹은 물결(~) 기호를 이용하여 HEAD의 상대 커밋 위치를 지정

<br>

## 9.2.2 reset 명령어

+ reset 명령어를 사용하면 지정된 코드로 되돌아감

+ `$ git reset <옵션> <커밋ID>` : 특정 커밋의 해시 값 상태로 모든 코드를 복구

+ reset 명령어의 옵션(3가지)

  + soft : 스테이지 영역을 포함한 상태로 복원

  + mixed : 기본 옵션 값(default)

  + hard : 실제 파일이 삭제된 이전 상태로 복원

<br>

## 9.2.3 soft 옵션

+ `$ git reset --soft <커밋ID>`

+ ![9 2 3](https://user-images.githubusercontent.com/107418955/202684049-e7c6691f-dc07-4976-a974-17d49bc0dfe4.png)

+ soft 옵션은 지정한 커밋 위치로 복귀

+ 복귀하면서 스테이지 영역의 상태도 같이 복귀

+ soft 옵션은 파일을 수정하고, add 명령어로 스테이지 영역에 올려 커밋을 실행하기 직전의 단계로 되돌림
 
+ reset --soft 명령어의 원리를 이용하면 마지막 커밋을 수정할 수 있음

+ `$ git commit --amend` : --amend 명령어와 유사

<br>

## 9.2.4 mixed 옵션

+ mixed는 reset 명령어의 기본값

+ `$ git reset --mixed <커밋ID>` 또는 `$ git reset <커밋ID>` 로 작성

+ mixed 옵션은 soft 옵션과는 다르게 리셋 후 스테이지 상태까지 복원하지 않음

+ mixed 옵션은 스테이지 상태를 제외하고 복원하기 때문에 커밋을 하려면 add 명령어를 먼저 

<br>

## 9.2.5 hard 옵션

+ soft 옵션과 mixed 옵션은 이전 커밋으로 되돌리는 과정에서 실제로 삭제되는 내용 없이 모든 작업 내용이 워킹 디렉터리에 유지

+ hard 옵션은 리셋되는 복귀 시점의 커밋 상태와 해당 커밋의 워킹 디렉터리까지 모두 되돌림

+ `$ git reset --hard` : 명령어를 사용한 커밋 이루의 모든 내용 삭제

<br>

## 9.2.7 커밋 합치기

+ 리베이스 병합의 -i 옵션을 사용하면 여러 커밋을 하나로 합치는 동작 수행 가능

+ 단일 커밋은 커밋 명령어의 --amend 옵션으로 커밋을 수정할 수 있음

+ `$ git reset --soft HEAD~2` : 2단계 전의 커밋으로 리셋

+ `$ git diff HEAD~` : 커밋 비교

<br>

## 9.2.8 스테이지 리셋

+ 스테이지 영역은 커밋을 하려고 임시로 결과물을 보관해 두는 공간

+ `$ git add <파일이름>` : 스테이지 열역에 등록

+ `$ git reset <파일이름>` : 스테이지 영역에서 등록된 파일을 다시 unstage 상태로 

+ `$ git reset --mixed HEAD <파일이름>` : 몇 가지 옵션이 축약되어 있으며, 내부적으로 여러 단계로 처리하여 파일을 unstage상태로 변경

<br>

## 9.2.9 작업 취소

+ 수정작업을 완전히 취소하여면 위킹 디렉토리와 스테이지 상태를 모두 제거하여 마지막 커밋 상태로 되돌려 놓아야 함

+ 리셋할 때의 시점을 현재 HEAD를 기준으로 하면 해당 시점의 수정 작업을 모두 삭제 가능

+ `$ git reset --hard HEAD`

<br>

## 9.2.10 병합 취소

+ 리셋은 병합된 브랜치도 취소 가능

+ `$ git reset --merge HEAD~`

<br>
<br>

# 9.3 
